@echo off
chcp 65001 >nul
echo ????????????...

REM ??????Python??
set VENV_PYTHON=f:\langchian\demo\.venv\Scripts\python.exe

REM ??Python????
%VENV_PYTHON% --version >nul 2>&1
if errorlevel 1 (
    echo ??: ???????Python?????????
    pause
    exit /b 1
)

REM ??schedule?????
echo ??schedule?...
%VENV_PYTHON% -c "import schedule" >nul 2>&1
if errorlevel 1 (
    echo schedule?????????...
    %VENV_PYTHON% -m pip install schedule
    if errorlevel 1 (
        echo ??schedule???
        pause
        exit /b 1
    )
    echo schedule?????
)

REM ??akshare?????
echo ??akshare?...
%VENV_PYTHON% -c "import akshare" >nul 2>&1
if errorlevel 1 (
    echo akshare?????????...
    %VENV_PYTHON% -m pip install akshare
    if errorlevel 1 (
        echo ??akshare???
        pause
        exit /b 1
    )
    echo akshare?????
)

echo ??????...
cd /d "%~dp0"
%VENV_PYTHON% schedule_task.py

pause
